{% extends "base.html" %}
{% block content %}
<div class="row">
  <div class="col-xs-12 col-sm-12 col-md-6">
    <div class="row">
      <div class="col-xs-12">
        <form action="" method="get" class="form-inline" id="form-search">
            <div class="form-group">
              <label>
              Zoek <i class="fa fa-search" aria-hidden="true"></i>
              </label>
              <input type="text" class="form-control" name="query" value="" placeholder="Amsterdam">
            </div>
        </form>
      </div>
    </div>
    <div class="row">
      <div class="col-xs-12" style="padding-top: 20px; padding-bottom: 20px;">
        <a href="#" id ="btn-location">
          <i class="fa fa-map-marker" aria-hidden="true"></i> Gebruik mijn locatie
        </a>
      </div>
    </div>
    <div class="row">
      <div class="col-xs-12" id="results-search">
      </div>
    </div>
  </div>
  <div class="col-xs-12 col-sm-12 col-md-6">
    <div id="map" style="height: 300px;"></div>
  </div>
</div>

<!-- Make sure you put this AFTER Leaflet's CSS -->
<script src="https://unpkg.com/leaflet@1.3.1/dist/leaflet.js"
  integrity="sha512-/Nsx9X4HebavoBvEBuyp3I7od5tA0UzAxs+j83KgC8PU0kgB4XiK4Lfe4y4cgBtaRJQEIFCW+oC506aPT2L1zw=="
  crossorigin=""></script>
<script>

    var StembureausApp = window.StembureausApp || {stembureaus: []};

    StembureausApp.stembureaus = {{ records.records |tojson |safe }};
    StembureausApp.stembureaus_markers = [];

    for(var i=0; i < StembureausApp.stembureaus.length; i++) {
      StembureausApp.stembureaus_markers.push(
        L.marker(
          [StembureausApp.stembureaus[i].Latitude, StembureausApp.stembureaus[i].Longitude]
        ).bindPopup(
          "<a href=\"/s/" + StembureausApp.stembureaus[i]['Gemeente'] + '/' + StembureausApp.stembureaus[i]['primary_key'] + "\">" + StembureausApp.stembureaus[i]['Naam stembureau'] + "</a><p><b>Openingstijden:</b>" + StembureausApp.stembureaus[i]['Openingstijden'] + "</p>"
        )
      );
    }


    StembureausApp.layers = {
      'Stembureaus': L.layerGroup(StembureausApp.stembureaus_markers)
    };
    StembureausApp.map = L.map('map', {'layers': StembureausApp.layers['Stembureaus']}).setView([52.2, 5.592], 6);
    StembureausApp.group = L.featureGroup(StembureausApp.stembureaus_markers);
    StembureausApp.map.fitBounds(StembureausApp.group.getBounds());

    L.tileLayer('http://{s}.tile.osm.org/{z}/{x}/{y}.png', {
        attribution: '&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'
    }).addTo(StembureausApp.map);

</script>
{% endblock %}
